# core/ai_service.py
import asyncio

class AIService:
    def __init__(self):
        # –°–ø–∏—Å–æ–∫ –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ (–∏–º–∏—Ç–∞—Ü–∏—è)
        self.scripted_questions = [
            "–ö–∞–∫ –¥–∞–≤–Ω–æ —É –≤–∞—Å –ø–æ—è–≤–∏–ª–∏—Å—å —ç—Ç–∏ —Å–∏–º–ø—Ç–æ–º—ã?",
            "–û—Ü–µ–Ω–∏—Ç–µ –±–æ–ª—å –ø–æ —à–∫–∞–ª–µ –æ—Ç 1 –¥–æ 10.",
            "–ï—Å—Ç—å –ª–∏ —É –≤–∞—Å —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è?",
            "–ü—Ä–∏–Ω–∏–º–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–µ–π—á–∞—Å –∫–∞–∫–∏–µ-—Ç–æ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞?"
        ]

    async def get_next_question(self, history: list[str]) -> str | None:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å –∏–∑ —Å–ø–∏—Å–∫–∞.
        –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –±–æ–ª—å—à–µ –Ω–µ—Ç - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç None.
        """
        # –°—á–∏—Ç–∞–µ–º, —Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤ —É–∂–µ –±—ã–ª–æ (–º–∏–Ω—É—Å 1, —Ç–∞–∫ –∫–∞–∫ –ø–µ—Ä–≤–æ–µ - —ç—Ç–æ –∂–∞–ª–æ–±–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞)
        # history = ["–ñ–∞–ª–æ–±–∞: –±–æ–ª–∏—Ç", "–û—Ç–≤–µ—Ç 1", "–û—Ç–≤–µ—Ç 2"]
        answers_count = len(history) - 1
        
        if answers_count < len(self.scripted_questions):
            return self.scripted_questions[answers_count]
        
        return None

    async def analyze_anamnesis(self, history: list[str]) -> str:
        """
        –ò–º–∏—Ç–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞.
        """
        
        return (
            "ü§ñ **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º):**\n"
            "–ü–∞—Ü–∏–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω–∏–ª –æ–ø—Ä–æ—Å–Ω–∏–∫. –¢—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞.\n"
            "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π."
        )